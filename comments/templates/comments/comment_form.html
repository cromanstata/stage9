{% load comments_tags %}
{% can_rate target user as can_rate_flag %}

{% if not user.is_authenticated and not allow_anonymous %}
{% else %}
	<div id="comment-input-div">
		<form method="POST" action="{% url "comment-create" %}" class="add-comment-form">
			{% csrf_token %}
			{{ form.errors }}
        <h4>Post a comment</h4>
			<br>
			{{ form.comment }}
            {{ form.rating }}
            {% if can_rate_flag %}
                <div id="rate_the_recipe">
                     <p>RATE THE RECIPE:</p>
                    {% include "comments/comment_rating.html" %}
                </div>
            {% endif %}
			{% if target %}	
				<input name="model" value="{% get_model_name target %}" hidden>
				<input name="model_id" value="{{ target.id }}" hidden>
				<input name="app_name" value="{% get_app_name target %}" hidden>
			{% endif %}
			<input id="id_user" name="user" value="{% if user.is_authenticated %}{{ user.id }}{% endif %}" hidden>
			<input type="submit" value="Submit" id="add-comment" />
		</form>
	</div>
{% endif %}

